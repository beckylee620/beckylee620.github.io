<!DOCTYPE html>
<html>
    <head>
        <title>Lounger</title>
    </head>

    <body style="text-align:center">
        <div id="header">
          <div id="text_cutout_background">
            <div id="text_cutout">Lounger</div>
          </div>
        </div>

        <div style="text-align:center">GAUGE</div>
        <div id="input">
        <form class="input_form" id="gauge_form" action="form_action.asp">
            <div class="input_section">width of ten stitches<input type="number" name="gauge_width"></div>
            <div class="input_section">length of ten rows<input type="number" name="gauge_length"></div>
        </form>
        </div>

        <div style="text-align:center">BODY MEASUREMENTS</div>
        <div id="input">
        <form class="input_form" id="body_form" action="form_action.asp">
            <div class="input_section">neck circumference<input type="number" name="neck_circumference"></div>
            <div class="input_section">shoulder width<input type="number" name="shoulder_width"></div>
            <div class="input_section">bicep circumference<input type="number" name="bicep_circumference"></div>
        </form>
        </div>

        <div style="text-align:center">GARMENT MEASUREMENTS</div>
        <div id="input">
        <form class="input_form" id="garment_form" action="form_action.asp">
            <div class="input_section">body circumference<input type="number" name="body_circumference"></div>
            <div class="input_section">back length<input type="number" name="back_length"></div>
            <div class="input_section">collar height<input type="number" name="collar_height"></div>
            <div class="input_section">sleeve length<input type="number" name="sleeve_length"></div>
            <div class="input_section">cuff circumference<input type="number" name="cuff_circumference"></div>
        </form>
        </div>

        <div style="text-align:center">DESIGN OPTIONS</div>
        <div id="input">
        <form class="input_form" id="design_form" action="form_action.asp">
            <div class="input_section">make divisible by...<input type="number" name="divisor"></div>
            <div class="input_section">...plus<input type="number" name="divisor_plus"></div>
            <div class="input_section">collar openness<input type="number" name="collar_openness"></div>
            <div class="input_section">folded collar<input type="number" name="folded_collar"></div>
        </form>
        </div>

        <button style="display:inline-block;width:40%;text-align:center" onclick="calculate()">calculate</button>

        <script>

/* vvvv this doesn't appear to work across a group of elements (seems to have worked on a single one)
        input = document.getElementsByClassName("input_section");
        input.addEventListener("mousewheel", function(evt){ evt.preventDefault(); });
/* ^^^^ */

        function calculate() {
            var gauge_form = document.getElementById("gauge_form");
            var body_form = document.getElementById("body_form");
            var garment_form = document.getElementById("garment_form");
            var design_form = document.getElementById("design_form");

            var gauge_width = gauge_form.elements[0].value;
            var gauge_length = gauge_form.elements[1].value;
            var neck_circumference = body_form.elements[0].value;
            var shoulder_width = body_form.elements[1].value;
            var bicep_circumference = body_form.elements[2].value;
            var body_circumference = garment_form.elements[0].value;
            var back_length = garment_form.elements[1].value;
            var collar_height = garment_form.elements[2].value;
            var sleeve_length = garment_form.elements[3].value;
            var cuff_circumference = garment_form.elements[4].value;
            var divisor = design_form.elements[0].value;
            var divisor_plus = design_form.elements[1].value;
            var collar_openness = design_form.elements[2].value;
            var folded_collar = design_form.elements[3].value;

/* problem if shoulder_width is wider than 1/2 body_circumference? */
/* fyi Math.round rounds to the nearest integer - Math.floor / Math.ceil */

            var body_circumference_total = Math.round(body_circumference / gauge_width * 10);
            var back_panel_stitches = Math.round(body_circumference_total / 2);
            var front_panel_start_stitches = Math.round(back_panel_stitches * .05);
            var shoulder_to_shoulder_stitches = Math.round(shoulder_width / gauge_width * 10);
            var shoulder_short_row_stitches = Math.round((back_panel_stitches - shoulder_to_shoulder_stitches) / 2);
            var front_panel_end_stitches = Math.round(back_panel_stitches - shoulder_short_row_stitches);

            /* currently making the rise of the shoulder triangle 1/4 the length of the run */
            var shoulder_short_row_rows = Math.round((shoulder_short_row_stitches / (gauge_width * 10)) / 4 / gauge_length * 10);
            shoulder_short_row_rows -= (shoulder_short_row_rows % 2);
            shoulder_short_row_iterations = Math.round(shoulder_short_row_rows / 2);
            var shoulder_short_row_decreases = Math.floor(shoulder_short_row_stitches / shoulder_short_row_iterations);
            var shoulder_short_row_leftovers = Math.round(shoulder_short_row_stitches % shoulder_short_row_decreases);

            /* not sure if these adjustments vvv will definitely always work out evenly - test */
            var front_panel_increases = Math.round(front_panel_end_stitches - front_panel_start_stitches);
            var body_rows_total = Math.round(back_length / gauge_length * 10);
            body_rows_total += (body_rows_total % 2);
            var front_panel_increase_rate = Math.floor(body_rows_total / front_panel_increases);
            var front_panel_increases_adjusted = Math.round(body_rows_total / front_panel_increase_rate);
            var front_panel_start_stitches_adjusted = Math.round(front_panel_end_stitches - front_panel_increases_adjusted);
            var cast_on = Math.round(back_panel_stitches + (front_panel_start_stitches_adjusted * 2));

            var drop_sleeve_body_rows = Math.round(bicep_circumference * 1.1 / gauge_length * 10);
            drop_sleeve_body_rows -= (drop_sleeve_body_rows % 2)
            /* note: there is an extra body row after the shoulder short rows that is not accounted for here */
            var body_rows_before_sleeve = Math.round(body_rows_total - drop_sleeve_body_rows - shoulder_short_row_rows);

            /* is this right?? */
            var front_panel_pickup_stitches = (Math.floor(body_rows_before_sleeve / front_panel_increase_rate) + front_panel_start_stitches_adjusted)

            var drop_sleeve_pickup_stitches = Math.round(bicep_circumference * 1.1 / gauge_width * 10);
            var sleeve_rows_total = Math.round(sleeve_length / gauge_length * 10);


            /* old front panel calculation */
            // var front_panel_stitches_with_shoulder = Math.round(back_panel_stitches / 2);
            // var shoulder_to_shoulder_stitches = Math.round(shoulder_width / gauge_width * 10);
            // var front_panel_stitches_inside_shoulders = Math.round(shoulder_to_shoulder_stitches / 2);
            // var front_panel_increase_rate = Math.round(body_rows_total / front_panel_stitches_inside_shoulders);
            // var front_panel_increases_adjusted = Math.round(body_rows_total / front_panel_increase_rate);
            // var front_panel_end_stitches = Math.round(front_panel_stitches_inside_shoulders * crossover_point / 100 + front_panel_stitches_with_shoulder);
            // var front_panel_start_stitches = Math.round(front_panel_end_stitches - front_panel_increases_adjusted);
            // var cast_on = Math.round(front_panel_start_stitches * 2 + back_panel_stitches);

            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputB").innerHTML = body_rows_before_sleeve;
            document.getElementById("outputC").innerHTML = front_panel_increase_rate;
            document.getElementById("outputD").innerHTML = front_panel_pickup_stitches;
            document.getElementById("outputE").innerHTML = back_panel_stitches;
            document.getElementById("outputF").innerHTML = drop_sleeve_body_rows;
            document.getElementById("outputG").innerHTML = shoulder_short_row_rows;
            document.getElementById("outputH").innerHTML = shoulder_short_row_decreases;
            document.getElementById("outputI").innerHTML = shoulder_short_row_iterations;
            document.getElementById("outputJ").innerHTML = shoulder_short_row_leftovers;
            document.getElementById("outputK").innerHTML = shoulder_short_row_stitches;
            document.getElementById("outputL").innerHTML = cast_on;
            document.getElementById("outputM").innerHTML = cast_on;
            document.getElementById("outputN").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputA").innerHTML = cast_on;
            document.getElementById("outputZ").innerHTML = cast_on;
        }
        </script>
        </div>

        <div style="width:95%;display:inline-block;text-align:center;vertical-align:text-top;padding:1.2%">
        <p>OUTPUT</p>
        <table>
            <tr>
                <td>A</td>
                <td id="outputA"></td>
            </tr>
            <tr>
                <td>B</td>
                <td id="outputB"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>D</td>
                <td id="outputD"></td>
            </tr>
            <tr>
                <td>E</td>
                <td id="outputE"></td>
            </tr>
            <tr>
                <td>F</td>
                <td id="outputF"></td>
            </tr>
            <tr>
                <td>G</td>
                <td id="outputG"></td>
            </tr>
            <tr>
                <td>H</td>
                <td id="outputH"></td>
            </tr>
            <tr>
                <td>I</td>
                <td id="outputI"></td>
            </tr>
            <tr>
                <td>J</td>
                <td id="outputJ"></td>
            </tr>
            <tr>
                <td>K</td>
                <td id="outputK"></td>
            </tr>
            <tr>
                <td>L</td>
                <td id="outputL"></td>
            </tr>
            <tr>
                <td>M</td>
                <td id="outputM"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
            <tr>
                <td>C</td>
                <td id="outputC"></td>
            </tr>
        </table>

        </div>


    <link rel="stylesheet" type="text/css" href="patternstylesheet.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Ubuntu" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.3/jquery.mobile.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.3/jquery.mobile.min.js"></script>

    </body>
</html>
